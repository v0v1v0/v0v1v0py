<div class="container">

<table style="width: 100%;"><tr>
<td>IC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Information criteria for the stochastic differential equation
</h2>

<h3>Description</h3>

<p>Information criteria BIC, Quasi-BIC (QBIC) and CIC for the stochastic differential equation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">IC(drif = NULL, diff = NULL, jump.coeff = NULL, data = NULL, Terminal = 1, 
   add.settings = list(), start, lower, upper, ergodic = TRUE,
   stepwise = FALSE, weight = FALSE, rcpp = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>drif</code></td>
<td>

<p>a character vector that each element presents the candidate drift coefficient.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff</code></td>
<td>

<p>a character vector that each element presents the candidate diffusion coefficient.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jump.coeff</code></td>
<td>

<p>a character vector that each element presents the candidate scale coefficient.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>the data to be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Terminal</code></td>
<td>

<p>terminal time of the grid.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.settings</code></td>
<td>

<p>details of model settings(see <code>setModel</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>

<p>a named list of the initial values of the parameters for optimization.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>

<p>a named list for specifying lower bounds of the parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>

<p>a named list for specifying upper bounds of the parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ergodic</code></td>
<td>

<p>whether the candidate models are ergodic SDEs or not(default <code>ergodic=TRUE</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepwise</code></td>
<td>

<p>specifies joint procedure or stepwise procedure(default <code>stepwise=FALSE</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>

<p>calculate model weight? (default <code>weight=FALSE</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rcpp</code></td>
<td>

<p>use C++ code? (default <code>rcpp=FALSE</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>passed to <code>qmle</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculate the information criteria BIC, QBIC, and CIC for stochastic processes.
The calculation and model selection are performed by joint procedure or stepwise procedure.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>

<p>values of BIC for all candidates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QBIC</code></td>
<td>

<p>values of QBIC for all candidates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>

<p>values of AIC-type information criterion for all candidates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>information of all candidate models.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>

<p>quasi-maximum likelihood estimator for each candidate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>

<p>model weights for all candidates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selected</code></td>
<td>

<p>selected model number and selected drift and diffusion coefficients
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The function <code>IC</code> uses the function <code>qmle</code> with <code>method="L-BFGS-B"</code> internally.
</p>


<h3>Author(s)</h3>

<p>The YUIMA Project Team
</p>
<p>Contacts: Shoichi Eguchi <a href="mailto:shoichi.eguchi@oit.ac.jp">shoichi.eguchi@oit.ac.jp</a>
</p>


<h3>References</h3>

<p>## AIC, BIC
</p>
<p>Akaike, H. (1973). Information theory and an extension of the maximum likelihood principle. In Second International Symposium on Information Theory (Tsahkadsor, 1971), 267-281. <a href="https://doi.org/10.1007/978-1-4612-1694-0_15">doi:10.1007/978-1-4612-1694-0_15</a>
</p>
<p>Schwarz, G. (1978). Estimating the dimension of a model. The Annals of Statistics, 6(2), 461-464. <a href="https://doi.org/10.1214/aos/1176344136">doi:10.1214/aos/1176344136</a>
</p>
<p>## BIC, Quasi-BIC
</p>
<p>Eguchi, S. and Masuda, H. (2018). Schwarz type model comparison for LAQ models. Bernoulli, 24(3), 2278-2327. <a href="https://doi.org/10.3150/17-BEJ928">doi:10.3150/17-BEJ928</a>.
</p>
<p>## CIC
</p>
<p>Uchida, M. (2010). Contrast-based information criterion for ergodic diffusion processes from discrete observations. Annals of the Institute of Statistical Mathematics, 62(1), 161-187. <a href="https://doi.org/10.1007/s10463-009-0245-1">doi:10.1007/s10463-009-0245-1</a>
</p>
<p>## Model weight
</p>
<p>Burnham, K. P. and Anderson, D. R. (2002). Model Selection and Multimodel Inference. Springer-Verlag, New York.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
### Ex.1 
set.seed(123)

N &lt;- 1000   # number of data
h &lt;- N^(-2/3)  # sampling stepsize
Ter &lt;- N*h  # terminal sampling time

## Data generate (dXt = -Xt*dt + exp((-2*cos(Xt) + 1)/2)*dWt)
mod &lt;- setModel(drift="theta21*x", diffusion="exp((theta11*cos(x)+theta12)/2)")
samp &lt;- setSampling(Terminal=Ter, n = N)
yuima &lt;- setYuima(model=mod, sampling=setSampling(Terminal=Ter, n=50*N))
simu.yuima &lt;- simulate(yuima, xinit=1, true.parameter=list(theta11=-2, theta12=1, 
                       theta21=-1), subsampling=samp)
Xt &lt;- NULL
for(i in 1:(N+1)){
  Xt &lt;- c(Xt, simu.yuima@data@original.data[50*(i-1)+1])
}

## Candidate coefficients
diffusion &lt;- c("exp((theta11*cos(x)+theta12*sin(x)+theta13)/2)", 
               "exp((theta11*cos(x)+theta12*sin(x))/2)", 
               "exp((theta11*cos(x)+theta13)/2)", "exp((theta12*sin(x)+theta13)/2)")
drift &lt;- c("theta21*x + theta22", "theta21*x")

## Parameter settings
para.init &lt;- list(theta11=runif(1,max=5,min=-5), theta12=runif(1,max=5,min=-5), 
                  theta13=runif(1,max=5,min=-5), theta21=runif(1,max=-0.5,min=-1.5),
                  theta22=runif(1,max=-0.5,min=-1.5))
para.low &lt;- list(theta11=-10, theta12=-10, theta13=-10, theta21=-5, theta22=-5)
para.upp &lt;- list(theta11=10, theta12=10, theta13=10, theta21=-0.001, theta22=-0.001)

## Ex.1.1 Joint
ic1 &lt;- IC(drif=drift, diff=diffusion, data=Xt, Terminal=Ter, start=para.init, lower=para.low, 
          upper=para.upp, stepwise = FALSE, weight = FALSE, rcpp = TRUE)
ic1

## Ex.1.2 Stepwise
ic2 &lt;- IC(drif=drift, diff=diffusion, data=Xt, Terminal=Ter, 
          start=para.init, lower=para.low, upper=para.upp,
          stepwise = TRUE, weight = FALSE, rcpp = TRUE)
ic2


### Ex.2 (multidimansion case) 
set.seed(123)

N &lt;- 3000   # number of data
h &lt;- N^(-2/3)  # sampling stepsize
Ter &lt;- N*h  # terminal sampling time

## Data generate
diff.coef.matrix &lt;- matrix(c("beta1*x1+beta3", "1", "-1", "beta1*x1+beta3"), 2, 2)
drif.coef.vec &lt;- c("alpha1*x1", "alpha2*x2")
mod &lt;- setModel(drift = drif.coef.vec, diffusion = diff.coef.matrix, 
                state.variable = c("x1", "x2"), solve.variable = c("x1", "x2"))
samp &lt;- setSampling(Terminal = Ter, n = N)
yuima &lt;- setYuima(model = mod, sampling = setSampling(Terminal = N^(1/3), n = 50*N))
simu.yuima &lt;- simulate(yuima, xinit = c(1,1), true.parameter = list(alpha1=-2, alpha2=-1, 
                       beta1=-1, beta3=2), subsampling = samp)
Xt &lt;- matrix(0,(N+1),2)
for(i in 1:(N+1)){
  Xt[i,] &lt;- simu.yuima@data@original.data[50*(i-1)+1,]
}

## Candidate coefficients
diffusion &lt;- list(matrix(c("beta1*x1+beta2*x2+beta3", "1", "-1", "beta1*x1+beta2*x2+beta3"), 2, 2),
                  matrix(c("beta1*x1+beta2*x2", "1", "-1", "beta1*x1+beta2*x2"), 2, 2),
                  matrix(c("beta1*x1+beta3", "1", "-1", "beta1*x1+beta3"), 2, 2),
                  matrix(c("beta2*x2+beta3", "1", "-1", "beta2*x2+beta3"), 2, 2),
                  matrix(c("beta1*x1", "1", "-1", "beta1*x1"), 2, 2),
                  matrix(c("beta2*x2", "1", "-1", "beta2*x2"), 2, 2),
                  matrix(c("beta3", "1", "-1", "beta3"), 2, 2))
drift &lt;- list(c("alpha1*x1", "alpha2*x2"), c("alpha1*x2", "alpha2*x1"))
modsettings &lt;- list(state.variable = c("x1", "x2"), solve.variable = c("x1", "x2"))

## Parameter settings
para.init &lt;- list(alpha1 = runif(1,min=-3,max=-1), alpha2 = runif(1,min=-2,max=0),
                  beta1 = runif(1,min=-2,max=0), beta2 = runif(1,min=0,max=2), 
                  beta3 = runif(1,min=1,max=3))
para.low &lt;- list(alpha1 = -5, alpha2 = -5, beta1 = -5, beta2 = -5, beta3 = 1)
para.upp &lt;- list(alpha1 = 0.01, alpha2 = -0.01, beta1 = 5, beta2 = 5, beta3 = 10)

## Ex.2.1 Joint
ic3 &lt;- IC(drif=drift, diff=diffusion, data=Xt, Terminal=Ter, add.settings=modsettings, 
          start=para.init, lower=para.low, upper=para.upp, 
          weight=FALSE, rcpp=FALSE)
ic3

## Ex.2.2 Stepwise
ic4 &lt;- IC(drif=drift, diff=diffusion, data=Xt, Terminal=Ter, add.settings=modsettings, 
             start=para.init, lower=para.low, upper=para.upp,
             stepwise = TRUE, weight=FALSE, rcpp=FALSE)
ic4


## End(Not run)
</code></pre>


</div>